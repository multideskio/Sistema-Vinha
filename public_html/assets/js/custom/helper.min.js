var quill=new Quill("#editor",{theme:"snow"});function atualizarTabela(search=!1,page=1){$("#tabela-dados").empty(),$("#cardResult").hide(),$(".loadResult").show();var url=_baseUrl+"api/v1/ajuda?";search&&(url+="search="+search+"&"),page&&(url+="page="+page),$.getJSON(url).done((function(data,textStatus,jqXHR){$("#numResults").html(data.num),$("#pager").html(data.pager),0===data.rows.length?($("#cardResult").hide(),$(".noresult").show()):($(".noresult").hide(),$("#cardResult").show(),$.each(data.rows,(function(index,row){var newRow=`\n            <tr>\n                <td>${row.id}</td>\n                <td>${row.titulo}</td>\n                <td>${row.tags}</td>\n                <td>${row.conteudo}</td>\n                <td style="white-space: nowrap;">${row.data}</td>\n                <td>\n                    <div class="btn-group" role="group">\n                        <a href="${row.slug}" class="btn btn-dark btn-sm sa-dark" target="_blank" title="Ver conteúdo">\n                            <i class="ri-links-line"></i>\n                        </a>\n                        <a href="#" onclick="deletarPost('${row.id}')" class="btn btn-danger btn-sm sa-warning" title="Excluir conteúdo">\n                            <i class="ri-delete-bin-6-line"></i>\n                        </a>\n                    </div>\n                </td>\n            </tr>\n            `;$("#tabela-dados").append(newRow)})))})).fail((function(jqXHR,textStatus,errorThrown){console.error("Erro ao carregar os dados:",textStatus,errorThrown)})).always((function(){$(".loadResult").hide()}))}function deletarPost(id){Swal.fire({title:"Tem certeza?",text:"Você não poderá reverter isso!",type:"warning",showCancelButton:!0,confirmButtonText:"Sim, exclua-o!",confirmButtonClass:"btn btn-primary w-xs me-2 mt-2",cancelButtonClass:"btn btn-danger w-xs mt-2",buttonsStyling:!1,showCloseButton:!0}).then(result=>{result.value&&$.ajax({type:"DELETE",url:`${_baseUrl}api/v1/ajuda/${id}`,dataType:"JSON"}).done(()=>{Swal.fire({title:"Excluído!",text:"O registro foi excluído com sucesso.",type:"success",confirmButtonClass:"btn btn-primary w-xs mt-2",buttonsStyling:!1}),atualizarTabela()}).fail(()=>{Swal.fire({title:"Erro ao excluir",text:"Ocorreu um erro ao tentar excluir o registro.",type:"error",confirmButtonClass:"btn btn-primary w-xs mt-2",buttonsStyling:!1})})})}$("#submitBtn").on("click",(function(event){event.preventDefault();var htmlContent=quill.root.innerHTML;$("#conteudo").val(htmlContent),$("#formHelper").ajaxSubmit({success:function(responseText,statusText,xhr,$form){atualizarTabela(),$("#formHelper")[0].reset(),quill.setContents([]),Swal.fire({title:"Cadastrado!",type:"success",confirmButtonClass:"btn btn-primary w-xs mt-2",buttonsStyling:!1})},error:function(xhr,status,error){xhr.responseJSON&&xhr.responseJSON.messages?exibirMensagem("error",xhr.responseJSON):exibirMensagem({messages:{error:"Erro desconhecido."}})}})})),$(document).ready((function(){atualizarTabela(),$("#inSearchBtn").click((function(e){var search;atualizarTabela($("#inSearch").val())})),$("#inSearch").keypress((function(e){var search;13===e.which&&atualizarTabela($("#inSearch").val())})),$("#pager").on("click","a",(function(e){e.preventDefault();var href=$(this).attr("href"),urlParams=new URLSearchParams(href),page=urlParams.get("page"),search=urlParams.get("search");console.log(page),isNaN(page)||atualizarTabela(search,page)}))}));