function updateSocial(){$(".enviaLinks").on("change",(function(){$(".formTexts").submit()})),$(".formTexts").ajaxForm({beforeSubmit:function(formData,jqForm,options){options.type="PUT"},success:function(responseText,statusText,xhr,$form){dataConfig(),$(".alertAlterado").show(),setTimeout(()=>{$(".alertAlterado").fadeOut()},1200)},error:function(xhr,status,error){console.log(xhr),console.log(status),console.log(error)}})}function updateImage(){$("#profile-img-file-input").on("change",(function(){$(".formUpload").submit()})),$(".formUpload").ajaxForm({beforeSubmit:function(formData,jqForm,options){console.log("Enviando...")},success:function(responseText,statusText,xhr,$form){dataConfig(),Swal.fire({text:"Imagem atualizada com sucesso!",icon:"success"})},error:function(xhr,status,error){Swal.fire({text:"Erro ao atualizar imagem",icon:"error"}),console.log(xhr),console.log(status),console.log(error)}})}function updateGeral(){$(".formGeral").ajaxForm({beforeSubmit:function(formData,jqForm,options){options.type="PUT"},success:function(responseText,statusText,xhr,$form){dataConfig(),Swal.fire({text:"Executado com sucesso!",icon:"success"})},error:function(xhr,status,error){Swal.fire({text:"Ocorreu um erro...",icon:"error"})}})}function dataConfig(){$.getJSON(`${_baseUrl}api/v1/administracao/${idEmp}`).done((function(data){const setCheckboxState=(selector,state)=>{$(selector).prop("checked",state)};data.logo&&$("#fotoPerfil").attr("src",data.logo),$("#viewNameUser").html(data.empresa),$("#facebook").val(data.facebook),$("#website").val(data.site),$("#instagram").val(data.instagram),$("#cnpj").val(data.cnpj),$("#razaosocial").val(data.empresa),$("#email").val(data.email),$("#fixo").val(data.telefone),$("#celular").val(data.celular),$("#cep").val(data.cep),$("#uf").val(data.uf),$("#cidade").val(data.cidade),$("#bairro").val(data.bairro),$("#complemento").val(data.complemento),$("#emailRemetente").val(data.email_remetente),$("#nomeRemetente").val(data.nome_remetente),$("#smtpHOST").val(data.smtp_host),$("#smtpLOGIN").val(data.smtp_user),$("#smtpPASS").val(data.smtp_pass),$("#smtpPORT").val(data.smtp_port);let smtpCRYPT=data.smtp_crypt;$("#smtpCRYPT option").each((function(){$(this).val()===smtpCRYPT&&$(this).prop("selected",!0)})),setCheckboxState("#ativarSMTP",1==data.ativar_smtp),$("#urlAPI").val(data.url_api),$("#instanceAPI").val(data.instance_api),$("#keyAPI").val(data.key_api),setCheckboxState("#ativawa",1==data.ativar_wa),$("#s3Bucket").val(data.s3_bucket_name),$("#s3Id").val(data.s3_access_key_id),$("#s3Key").val(data.s3_secret_access_key),$("#s3Cdn").val(data.s3_cdn);let regiaoSelecionada=data.s3_region;$("#s3Region option").each((function(){$(this).val()===regiaoSelecionada&&$(this).prop("selected",!0)}))})).fail((function(jqXHR,textStatus,errorThrown){$("#fotoPerfil").attr("src","https://placehold.co/50/00000/FFF?text=V"),console.error("Erro ao carregar os dados:",textStatus,errorThrown),$(".loadResult").hide(),Swal.fire({title:"Os dados não foram encontrados",icon:"error"}).then((function(result){history.back()}))})),$("#fotoPerfil").on("error",(function(){$(this).attr("src","https://placehold.co/50/00000/FFF?text=M")}))}function formataCampos(){const maskConfigs=[{selector:".cpf",mask:"000.000.000-00"},{selector:".cep",mask:"00000-000"},{selector:".telFixo",mask:"(00) 0000-0000"},{selector:".celular",mask:"+00 (00) 0 0000-0000"},{selector:".cnpj",mask:"00.000.000/0000-00"}];maskConfigs.forEach(config=>{$(config.selector).mask(config.mask)})}function envioDeTeste(){$("#testarS3").on("click",(function(){Swal.fire({text:"Realizando teste",icon:"info"}),$.ajax({url:`${_baseUrl}api/v1/administracao/teste/s3`,method:"GET",dataType:"json"}).done((function(data,textStatus,jqXHR){let iconType="success"===data.status?"success":"error";Swal.fire({title:"Teste S3.",text:data.message,icon:iconType,confirmButtonClass:"btn btn-primary w-xs mt-2",buttonsStyling:!1})})).fail((function(jqXHR,textStatus,errorThrown){Swal.fire({text:"Ocorreu um erro ao processar sua solicitação.",icon:"error"})})).always((function(){}))})),$("#testarEmail").on("click",(function(){let email=$("#emailUser").val();console.log(email),Swal.fire({title:`Estamos enviando um e-mail de teste para ${email}`,icon:"info"}),$.ajax({type:"POST",url:`${_baseUrl}api/v1/email/teste`,data:{email:email},dataType:"json",success:function(response){Swal.fire({text:"O E-mail foi enviado!",icon:"success"})},error:function(error){Swal.fire({title:"O e-email não foi enviado.",text:`${error.responseJSON.messages.error}`,icon:"error"})}})}))}$(document).ready((function(){dataConfig(),updateImage(),updateSocial(),updateGeral(),formataCampos(),envioDeTeste()}));