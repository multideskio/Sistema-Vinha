function exibirMensagem(type,error){let messages=error.messages,errorMessage="";for(let key in messages)messages.hasOwnProperty(key)&&(errorMessage+=`${messages[key]}\n`);Swal.fire({title:"error"===type?"Erro ao incluir registro":"Mensagem",text:errorMessage,icon:type,confirmButtonClass:"btn btn-primary w-xs mt-2",buttonsStyling:!1})}function atualizarTabela(search=!1,page=1){$("#perfilCards").empty(),$("#cardResult").hide(),$("#noresult").hide(),$(".loadResult").show();var url=_baseUrl+"api/v1/gerentes?";search&&(url+="search="+encodeURIComponent(search)+"&"),page&&(url+="page="+page),$.getJSON(url).done((function(data,textStatus,jqXHR){$("#numResults").html(data.num),$("#pager").html(data.pager),0===data.rows.length?($("#cardResult").hide(),$(".noresult").show()):($(".noresult").hide(),$("#cardResult").show()),$.each(data.rows,(function(index,gerente){var randomColor=Math.floor(16777215*Math.random()).toString(16),newPerfilCard=`<div class="col-xl-3">\n                    <div class="card shadow-sm h-100">\n                        <div class="card-body text-center">\n                            <div class="mx-auto avatar-md mb-3">\n                                <img src="${gerente.foto}" onerror="this.onerror=null; this.src='https://placehold.co/50/${randomColor}/FFF?text=${gerente.nome.charAt(0)}';" class="img-fluid rounded-circle" style="width: 100%; height: 100%; object-fit: cover;">\n                            </div>\n                            <h5 class="card-title mb-1">#${gerente.id} - ${gerente.nome} ${gerente.sobrenome}</h5>\n                            <hr>\n                            <div class="text-start">\n                                <p class="text-muted mb-2"><strong>CPF:</strong> ${gerente.cpf}</p>\n                                <p class="text-muted mb-2"><strong>Email:</strong> ${gerente.email}</p>\n                                <p class="text-muted mb-2"><strong>Celular:</strong> ${gerente.celular}</p>\n                                <p class="text-muted mb-0"><strong>Telefone:</strong> ${gerente.telefone}</p>\n                            </div>\n                        </div>\n                        <a href="${_baseUrl}admin/gerente/${gerente.id}" class="btn text-white bg-primary card-footer">\n                            <i class="ri-pencil-line"></i> EDITAR\n                        </a>\n                    </div>\n                </div>`;$("#perfilCards").append(newPerfilCard)})),$(".loadResult").hide()})).fail((function(jqXHR,textStatus,errorThrown){console.error("Erro ao carregar os dados:",textStatus,errorThrown),exibirMensagem("error",{messages:{error:"Erro ao carregar os dados."}}),$(".loadResult").hide()}))}function escapeString(str){return str.replace(/'/g,"\\'")}$(document).ready((function(){$(".cpf").mask("000.000.000-00"),$(".cep").mask("00000-000"),$(".telFixo").mask("(00) 0000-0000"),$(".celular").mask("+00 (00) 0 0000-0000"),atualizarTabela(),$("#inSearchBtn").click((function(e){var search;atualizarTabela($("#inSearch").val())})),$("#inSearch").keypress((function(e){var search;13===e.which&&atualizarTabela($("#inSearch").val())})),$("#pager").on("click","a",(function(e){e.preventDefault();var href=$(this).attr("href"),urlParams=new URLSearchParams(href),page=urlParams.get("page"),search=urlParams.get("search");console.log(page),isNaN(page)||atualizarTabela(search,page)})),$("#formCad").ajaxForm({beforeSubmit:function(formData,jqForm,options){Swal.fire({html:"Enviado dados!",icon:"info"})},success:function(responseText,statusText,xhr,$form){atualizarTabela(),$("#formCad")[0].reset(),Swal.fire({title:"Cadastrado!",icon:"success",confirmButtonClass:"btn btn-primary w-xs mt-2",buttonsStyling:!1})},error:function(xhr,status,error){xhr.responseJSON&&xhr.responseJSON.messages?exibirMensagem("error",xhr.responseJSON):exibirMensagem("error",{messages:{error:"Erro desconhecido."}})}})}));