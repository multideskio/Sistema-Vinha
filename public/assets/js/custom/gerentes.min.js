function exibirMensagem(type,error){let messages=error.messages,errorMessage="";for(let key in messages)messages.hasOwnProperty(key)&&(errorMessage+=`${messages[key]}\n`);Swal.fire({title:"error"===type?"Erro ao incluir registro":"Mensagem",text:errorMessage,icon:type,confirmButtonClass:"btn btn-primary w-xs mt-2",buttonsStyling:!1})}function atualizarTabela(search=!1,page=1){$("#tabela-dados").empty(),$("#cardResult").hide(),$(".loadResult").show();var url=_baseUrl+"api/v1/gerentes?";search&&(url+="search="+encodeURIComponent(search)+"&"),page&&(url+="page="+page),$.getJSON(url).done((function(data,textStatus,jqXHR){$("#numResults").html(data.num),$("#pager").html(data.pager),0===data.rows.length?($("#cardResult").hide(),$(".noresult").show()):($(".noresult").hide(),$("#cardResult").show()),$.each(data.rows,(function(index,gerente){var randomColor=Math.floor(16777215*Math.random()).toString(16),newRow=`\n                <tr>\n                    <td>\n                        <div class="image-container" style="width: 50px; height: 50px; overflow: hidden; border-radius: 50%;">\n                            <img src="${gerente.foto}" onerror="this.onerror=null; this.src='https://placehold.co/50/${randomColor}/FFF?text=${gerente.nome.charAt(0)}';" style="width: 100%; height: 100%; object-fit: cover;" class="rounded-circle">\n                        </div>\n                    </td>\n                    <td class="align-middle">#${gerente.id}</td>\n                    <td class="align-middle">${gerente.nome} ${gerente.sobrenome}</td>\n                    <td class="align-middle">${gerente.cpf}</td>\n                    <td class="align-middle">\n                        <a href="mailto:${gerente.email}"><b>${gerente.email}</b></a>\n                    </td>\n                    <td class="align-middle">\n                        <a data-bs-toggle="tooltip" data-bs-placement="top" title="Tel Celular" href="tel:${gerente.celular}"><span class="badge bg-dark rounded-pill">${gerente.celular}</span></a>\n                        <a data-bs-toggle="tooltip" data-bs-placement="top" title="Tel fixo" href="tel:${gerente.telefone}"><span class="badge bg-success rounded-pill">${gerente.telefone}</span></a>\n                    </td>\n                    <td class="align-middle">\n                        <div class="btn-group" role="group">\n                            <a href="javascript:;" onclick="recursoindisponivel()" class="btn btn-dark btn-sm sa-dark">\n                                <i class="ri-pencil-line"></i>\n                            </a>\n                            <a href="#" onclick="recursoindisponivel()" class="btn btn-danger btn-sm sa-warning">\n                                <i class="ri-delete-bin-6-line"></i>\n                            </a>\n                        </div>\n                    </td>\n                </tr>\n                `;$("#tabela-dados").append(newRow)})),$(".loadResult").hide()})).fail((function(jqXHR,textStatus,errorThrown){console.error("Erro ao carregar os dados:",textStatus,errorThrown),exibirMensagem("error",{messages:{error:"Erro ao carregar os dados."}}),$(".loadResult").hide()}))}function escapeString(str){return str.replace(/'/g,"\\'")}$(document).ready((function(){FilePond.registerPlugin(FilePondPluginFileEncode,FilePondPluginFileValidateSize,FilePondPluginImageExifOrientation,FilePondPluginImagePreview),FilePond.create(document.querySelector(".filepond-input-circle"),{labelIdle:"Clique para carregar a imagem",imagePreviewHeight:170,imageCropAspectRatio:"1:1",imageResizeTargetWidth:200,imageResizeTargetHeight:200,stylePanelLayout:"compact circle",styleLoadIndicatorPosition:"center bottom",styleProgressIndicatorPosition:"right bottom",styleButtonRemoveItemPosition:"left bottom",styleButtonProcessItemPosition:"right bottom"});var cleaveCpf=new Cleave(".cpf",{numericOnly:!0,delimiters:[".",".","-"],blocks:[3,3,3,2],uppercase:!0}),cleaveCep=new Cleave(".cep",{numericOnly:!0,delimiters:["-"],blocks:[5,3],uppercase:!0}),cleaveTelFixo=new Cleave(".telFixo",{numericOnly:!0,delimiters:["(",") ","-"],blocks:[0,2,4,4]}),cleaveCelular=new Cleave(".celular",{numericOnly:!0,delimiters:["+"," (",") "," ","-"],blocks:[0,2,2,1,4,4]});atualizarTabela(),$("#inSearchBtn").click((function(e){var search;atualizarTabela($("#inSearch").val())})),$("#inSearch").keypress((function(e){var search;13===e.which&&atualizarTabela($("#inSearch").val())})),$("#pager").on("click","a",(function(e){e.preventDefault();var href=$(this).attr("href"),urlParams=new URLSearchParams(href),page=urlParams.get("page"),search=urlParams.get("search");console.log(page),isNaN(page)||atualizarTabela(search,page)})),$("#formCad").ajaxForm({beforeSubmit:function(formData,jqForm,options){},success:function(responseText,statusText,xhr,$form){atualizarTabela(),$("#formCad")[0].reset(),Swal.fire({title:"Cadastrado!",icon:"success",confirmButtonClass:"btn btn-primary w-xs mt-2",buttonsStyling:!1})},error:function(xhr,status,error){xhr.responseJSON&&xhr.responseJSON.messages?exibirMensagem("error",xhr.responseJSON):exibirMensagem("error",{messages:{error:"Erro desconhecido."}})}})}));