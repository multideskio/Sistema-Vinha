function exibirMensagem(type,error){let errorMessage="";for(const key in error.messages)error.messages.hasOwnProperty(key)&&(errorMessage+=`${error.messages[key]}\n`);Swal.fire({title:"error"===type?"Erro ao incluir registro":"Mensagem",text:errorMessage,icon:type,confirmButtonClass:"btn btn-primary w-xs mt-2",buttonsStyling:!1})}function listRegioes(){$("#selectRegiao").empty().removeAttr("required"),$.getJSON(`${_baseUrl}api/v1/regioes`,{},data=>{data.rows.forEach(regiao=>{$("#selectRegiao").append(`<option value="${regiao.id}">${regiao.id} - ${regiao.nome}</option>`)}),$("#selectRegiao").attr("required",!0).attr("data-choices",!0),new Choices("#selectRegiao")}).fail(()=>{Swal.fire({title:"Cadastre regiÃµes antes de cadastrar um supervisor...",icon:"error",confirmButtonClass:"btn btn-primary w-xs mt-2",buttonsStyling:!1}).then(result=>{history.back()})})}function listGerentes(){$("#selectGerentes").empty().removeAttr("required"),$.getJSON(`${_baseUrl}api/v1/gerentes/list`,{},data=>{data.forEach(gerente=>{$("#selectGerentes").append(`<option value="${gerente.id}">${gerente.id} - ${gerente.nome} ${gerente.sobrenome}</option>`)}),$("#selectGerentes").attr("required",!0).attr("data-choices",!0),new Choices("#selectGerentes")}).fail(()=>{Swal.fire({title:"Cadastre gerentes antes de cadastrar um supervisor...",icon:"error",confirmButtonClass:"btn btn-primary w-xs mt-2",buttonsStyling:!1}).then(result=>{history.back()})})}function atualizarTabela(search=!1,page=1){$("#tabela-dados").empty(),$("#cardResult").hide(),$(".loadResult").show();let url=`${_baseUrl}api/v1/supervisores?`;search&&(url+=`search=${search}&`),page&&(url+=`page=${page}`),$.getJSON(url).done(data=>{$("#numResults").html(data.num),$("#pager").html(data.pager),0===data.rows.length?($("#cardResult").hide(),$(".noresult").show()):($("#cardResult").show(),$(".noresult").hide()),data.rows.forEach(row=>{const randomColor=Math.floor(16777215*Math.random()).toString(16);$("#tabela-dados").append(`\n                    <tr>\n                        <td>\n                            <div class="image-container" style="width: 50px; height: 50px; overflow: hidden; border-radius: 50%;">\n                                <img src="${row.foto}" onerror="this.onerror=null; this.src='https://placehold.co/50/${randomColor}/FFF?text=${row.nome.charAt(0)}';" style="width: 100%; height: 100%; object-fit: cover;" class="rounded-circle">\n                            </div>\n                        </td>\n                        <td class="align-middle">#${row.id}</td>\n                        <td class="align-middle">${row.nome||""} ${row.sobrenome||""}</td>\n                        <td class="align-middle">${row.gerente_nome||""} ${row.gerente_sobrenome||""}</td>\n                        <td class="align-middle">${row.regiao_nome||""}</td>\n                        <td class="align-middle">${row.cpf||""}</td>\n                        <td class="align-middle">\n                            <a href="mailto:${row.email||""}"><b>${row.email||""}</b></a>\n                        </td>\n                        <td class="align-middle">\n                            <a data-bs-toggle="tooltip" data-bs-placement="top" title="Tel Celular" href="tel:${row.celular||""}"><span class="badge bg-dark rounded-pill">${row.celular||""}</span></a>\n                            <a data-bs-toggle="tooltip" data-bs-placement="top" title="Tel fixo" href="tel:${row.telefone||""}"><span class="badge bg-success rounded-pill">${row.telefone||""}</span></a>\n                        </td>\n                        <td class="align-middle">\n                            <div class="btn-group" role="group">\n                                <a href="${_baseUrl}admin/supervisor/${row.id}" class="btn btn-primary btn-sm">\n                                    \x3c!-- <i class="ri-pencil-line"></i> --\x3e <b>EDITAR</b>\n                                </a>\n                                \x3c!-- <a href="#" onclick="recursoindisponivel()" class="btn btn-danger btn-sm sa-warning">\n                                    <i class="ri-delete-bin-6-line"></i>\n                                </a> --\x3e\n                            </div>\n                        </td>\n                    </tr>\n                `)}),$(".loadResult").hide()}).fail((jqXHR,textStatus,errorThrown)=>{console.error("Erro ao carregar os dados:",textStatus,errorThrown)})}$(document).ready((function(){FilePond.registerPlugin(FilePondPluginFileEncode,FilePondPluginFileValidateSize,FilePondPluginImageExifOrientation,FilePondPluginImagePreview),FilePond.create(document.querySelector(".filepond-input-circle"),{labelIdle:"Clique para carregar a imagem",imagePreviewHeight:170,imageCropAspectRatio:"1:1",imageResizeTargetWidth:200,imageResizeTargetHeight:200,stylePanelLayout:"compact circle",styleLoadIndicatorPosition:"center bottom",styleProgressIndicatorPosition:"right bottom",styleButtonRemoveItemPosition:"left bottom",styleButtonProcessItemPosition:"right bottom"});const initCleave=(selector,options)=>new Cleave(selector,options);initCleave(".cpf",{numericOnly:!0,delimiters:[".",".","-"],blocks:[3,3,3,2],uppercase:!0}),initCleave(".cep",{numericOnly:!0,delimiters:["-"],blocks:[5,3],uppercase:!0}),initCleave(".telFixo",{numericOnly:!0,delimiters:["(",") ","-"],blocks:[0,2,4,4]}),initCleave(".celular",{numericOnly:!0,delimiters:["+"," (",") "," ","-"],blocks:[0,2,2,1,4,4]}),atualizarTabela(),listRegioes(),listGerentes();const searchHandler=()=>{const search=$("#inSearch").val();atualizarTabela(search)};$("#inSearchBtn").click(searchHandler),$("#inSearch").keypress((function(e){13===e.which&&searchHandler()})),$("#pager").on("click","a",(function(e){e.preventDefault();const href=$(this).attr("href"),urlParams=new URLSearchParams(href),page=urlParams.get("page"),search=urlParams.get("search");isNaN(page)||atualizarTabela(search,page)})),$("#formCad").ajaxForm({beforeSubmit:()=>{},success:(responseText,statusText,xhr,$form)=>{atualizarTabela(),$("#formCad")[0].reset(),Swal.fire({title:"Cadastrado!",icon:"success",confirmButtonClass:"btn btn-primary w-xs mt-2",buttonsStyling:!1})},error:xhr=>{const errorMsg=xhr.responseJSON&&xhr.responseJSON.messages?xhr.responseJSON:{messages:{error:"Erro desconhecido."}};exibirMensagem("error",errorMsg)}})}));