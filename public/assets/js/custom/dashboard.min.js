var chartPieBasicColors=["#008FFB","#212529"],options={series:[],chart:{height:200,type:"pie"},labels:["CRÉDITO","PIX"],legend:{position:"bottom"},dataLabels:{dropShadow:{enabled:!1}},colors:chartPieBasicColors},chart=new ApexCharts(document.querySelector("#simple_pie_chart"),options);function applyGrowthRate(elementId,growthRate){const element=$("#"+elementId),iconClass=growthRate.startsWith("-")?"ri-arrow-right-down-line":"ri-arrow-right-up-line",textClass=growthRate.startsWith("-")?"text-danger":"text-success";element.html(`\n        <i class="${iconClass} fs-13 align-middle"></i> ${growthRate}\n    `).removeClass("text-danger text-success").addClass(textClass)}function statisticas(search=null){var url=`${_baseUrl}api/v1/transacoes/dashboard?`;if(search){var dates=search.split(" to "),dateIn,dateOut;url+=`dateIn=${dates[0]}&dateOut=${dates[1]}`}$.getJSON(url,(function(data,textStatus,jqXHR){$("#mesDash").html(data.mes.valor),$("#dashBoletos").html(data.boletos.valor),$("#dashPix").html(data.pix.valor),$("#dashCredito").html(data.credito.valor),$("#dashDebito").html(data.debito.valor),$("#dashAnual").html(data.totalAnual.valor),$("#dashTotal").html(data.totalGeral.valor),$("#dashUsers").html(data.totalUsers),applyGrowthRate("mesGrowth",data.mes.crescimento),applyGrowthRate("boletosGrowth",data.boletos.crescimento),applyGrowthRate("pixGrowth",data.pix.crescimento),applyGrowthRate("creditoGrowth",data.credito.crescimento),applyGrowthRate("debitoGrowth",data.debito.crescimento),applyGrowthRate("anualGrowth",data.totalAnual.crescimento),applyGrowthRate("totalGrowth",data.totalGeral.crescimento);var creditoValue,pixValue,seriesData=[parseFloat(data.credito.valor.replace("R$","").replace(",",".")),parseFloat(data.pix.valor.replace("R$","").replace(",","."))];chart.updateSeries(seriesData),search&&Swal.fire({text:"Atualizado...",icon:"success"})})).fail(()=>{Swal.fire({text:"Houve um erro ao atualizar...",icon:"error"})})}function dividirData01(inputString){const partes=inputString.split(" to ");if(2===partes.length){const dataInicio=partes[0],dataFim=partes[1];return{dataInicio:dataInicio,dataFim:dataFim}}return console.error("Formato de entrada inválido."),null}function dividirData(inputString){const partes=inputString.split(" to ");if(2===partes.length){const dataInicio=partes[0],dataFim=partes[1];return{dataInicio:dataInicio,dataFim:dataFim}}return console.error("Formato de entrada inválido."),null}function search(){$("#inSearchBtn").on("click",(function(e){var search;listaTransacoes($("#inSearch").val())})),$("#inSearch").on("keypress",(function(e){var search;13===e.which&&listaTransacoes($("#inSearch").val())})),$("#pager").on("click","a",(function(e){e.preventDefault();var href=$(this).attr("href"),urlParams=new URLSearchParams(href),page=urlParams.get("page"),search=urlParams.get("search");isNaN(page)||listaTransacoes(search,page)}))}function listaTransacoes(search=!1,page=1){$("#listaTransacoes").empty(),$("#tableTransacoes").hide(),$("#loadResult").show();var url=`${_baseUrl}api/v1/transacoes/lista?`;search&&(url+="search="+encodeURIComponent(search)+"&"),page&&(url+="page="+page),$.getJSON(url,(function(data,textStatus,jqXHR){$("#numResults").html(data.num),$("#pager").html(data.pager),$.each(data.rows,(function(indexInArray,row){let status;status="Pago"===row.status?'<span class="badge bg-success-subtle text-success">Pago</span>':"Cancelado"===row.status?'<span class="badge bg-danger-subtle text-danger">Cancelado</span>':"Reembolsado"===row.status?'<span class="badge bg-dark-subtle text-dark">Reembolsado</span>':'<span class="badge bg-warning-subtle text-warning">Aguardando</span>',$("#listaTransacoes").append(`<tr>\n                                <th scope="row">${row.id}</th>\n                                <td>${row.nome}<br><small class="text-muted">${row.email}</small></td>\n                                <td>${row.valor}</td>\n                                <td>${status}</td>\n                                <td>${row.forma_pg}</td>\n                                <td>\n                                <a href="${row.url}" class="btn btn-sm btn-soft-dark waves-effect waves-light">ver</a>\n                                </td>\n                            </tr>`)})),$("#tableTransacoes").show(),$("#loadResult").hide()}))}function searchUser(){$("#pagerUser").on("click","a",(function(e){e.preventDefault();var href=$(this).attr("href"),urlParams=new URLSearchParams(href),page=urlParams.get("page"),search=urlParams.get("search");isNaN(page)||listaUsuarios(search,page)}))}function listaUsuarios(search=!1,page=1){$("#listaUsuarios").empty(),$("#tableUsers").hide(),$("#loadResultUsers").show();var url=`${_baseUrl}api/v1/usuarios?`;search&&(url+="search="+encodeURIComponent(search)+"&"),page&&(url+="page="+page),$.getJSON(url,(function(data,textStatus,jqXHR){$.each(data.rows,(function(indexInArray,row){$("#listaUsuarios").append(`<tr>\n                                    <th scope="row">${row.id}</th>\n                                    <td>${row.nome}<br><small class="text-muted">${row.email}</small></td>\n                                    <td>${row.tipo}</td>\n                                    <td>\n                                    <a href="${row.url}" class="btn btn-sm btn-soft-dark waves-effect waves-light">ver</a>\n                                    </td>\n                                </tr>`)})),$("#tableUsers").show(),$("#loadResultUsers").hide(),$("#numResultsUsers").html(data.num),$("#pagerUser").html(data.pager)}))}chart.render(),$(document).ready((function(){statisticas(),listaTransacoes(),search(),listaUsuarios(),searchUser(),$("#btnSearchDash").on("click",(function(){var search=$("#testDate").val();search?(Swal.fire({text:"Atualizando painel...",icon:"info"}),statisticas(search)):Swal.fire({text:"Defina uma data para gerar o relatório...",icon:"error"})}))}));